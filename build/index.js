(()=>{"use strict";const e=window.wp.plugins,t=window.wp.compose,o=window.wp.data,n=window.React,s=window.wp.editor,i=window.wp.element,r=window.wp.components,a=window.wp.i18n,c=(0,t.compose)([(0,o.withSelect)((e=>{const{getCurrentPostId:t,getCurrentPostAttribute:o}=e("core/editor"),n=o("meta");return{postId:t(),meta:n}})),(0,o.withDispatch)((e=>({savePostMeta(t){e("core/editor").editPost({meta:t})},saveDocument(){e("core/editor").savePost()}})))])((({postId:e,meta:t,savePostMeta:c,saveDocument:l})=>{var d,p,u,w,m;let v=(0,o.select)("core/editor").getCurrentPostType(),h=window.AcjIeBlocksEditorSettings.settings;const{wpSettings:f}=h;if(-1===f.allowed_post_types.indexOf(v))return;const[y,g]=(0,i.useState)(!1);"post"===v&&(v="posts");const[_,S]=(0,i.useState)(null!==(d=t.speechify_enable_conversion)&&void 0!==d&&d),[P,b]=(0,i.useState)(null!==(p=t.speechify_conversion_id)&&void 0!==p?p:0),[E,C]=(0,i.useState)(null!==(u=t.speechify_conversion_link)&&void 0!==u?u:""),[A,j]=(0,i.useState)(null!==(w=t.speechify_conversion_audio)&&void 0!==w?w:""),[k,D]=(0,i.useState)(null!==(m=t.speechify_conversion_format)&&void 0!==m?m:"mp3"),[x,I]=(0,i.useState)(t.speechify_conversion_done);return(0,i.useEffect)((()=>{if(A){let e=((e,t)=>{let o=function(e){return{mp3:"audio/mpeg",aac:"audio/aac",wav:"audio/wav",ogg:"audio/ogg"}[e.toLowerCase()]||null}(t);if(!o)return void console.error("Unsupported audio format:",t);let n=((e,t)=>{let o=atob(e),n=new Array(o.length);for(let e=0;e<o.length;e++)n[e]=o.charCodeAt(e);let s=new Uint8Array(n);return new Blob([s],{type:t})})(e,o);return URL.createObjectURL(n)})(A,k);C(e)}}),[]),(0,n.createElement)(s.PluginDocumentSettingPanel,{name:`speechify-${v}-panel`,title:"Speechify",className:`speechify-${v}-panel`},_&&!P&&(0,n.createElement)("div",null,(0,a.__)("Conversions Enabled, Please save the Document to start processing.","acjpd-speechify-text-to-speech")),_&&P&&!E&&(0,n.createElement)("div",{style:{color:"red"}},(0,a.__)("Conversion failed, please check Api key.","acjpd-speechify-text-to-speech")),_&&P&&E&&x&&(0,n.createElement)("div",{id:"audio-container"},(0,n.createElement)("audio",{controls:!0},(0,n.createElement)("source",{src:E,type:"audio/mpeg"}),"Your browser does not support the audio element.")),!_&&(0,n.createElement)(r.Button,{disabled:y,onClick:async()=>{g(!0),c({speechify_enable_conversion:"true"}),S(!0),g(!1)},variant:"secondary"},"Convert to Speech"))}));(0,e.registerPlugin)("acjpd-speechify-text-to-speech-sidebar-panel",{render:c,icon:"palmtree"})})();